SELECT D,P,S,A FROM
(
SELECT  NAME,OCCUPATION,ROW_NUMBER() OVER (PARTITION BY  Occupation ORDER BY NAME) RN
FROM OCCUPATIONS
)
PIVOT
(
MAX(Name) 
    FOR OCCUPATION 
    IN ('Doctor' AS D,'Professor' AS P,'Singer' AS S,'Actor' AS A)
)ORDER BY RN;